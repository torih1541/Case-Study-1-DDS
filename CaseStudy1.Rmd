---
title: "Case Study 1- DS 6306"
output: html_document
date: "`r Sys.Date()`"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(tidyverse)
library(ggplot2)
library(readr)

```

## Introduction 

We have undertaken a comprehensive analysis of two important datasets that provide a detailed snapshot of the brewing industry. The first dataset encapsulates a wealth of information on 2,410 U.S. craft beers, covering aspects such as their alcohol by volume (ABV), International Bitterness Units (IBUs), and beer style. This data offers valuable insights into the popularity of various beer styles, the correlation between ABV and IBUs, and potential market trends.
The second dataset provides records on 558 U.S. breweries, including their location and size. This dataset will allow us to understand geographical distribution, market saturation, and opportunities for expansion. By cross-referencing these datasets, we can identify patterns and trends that could inform Budweiser's strategic decisions.
Our goal is to present these findings in a clear and impactful manner, focusing on the implications of the data rather than the technicalities of the analysis. We trust that these insights will contribute significantly to shaping Budweiser's future strategies. Thank you for your time, and we look forward to discussing our findings with you.

```{r beers and breweries}
beers <- read.csv("~/Downloads/Beers.csv")
breweries <- read.csv("~/Downloads/Breweries.csv")
```


How many breweries are present in each state?

```{r}
breweries_by_state <- breweries %>%
  group_by(State) %>%
  summarise(NumberOfBreweries = n())
```

Merge beer data with the breweries data. Print the first 6 observations and the last six observations to check the merged file.

```{r}
# Merge the data frames on the Brewery_id (in beers) and Brew_id (in breweries)
merged_data <- merge(beers, breweries, by.x = "Brewery_id", by.y = "Brew_ID")

# Print the first 6 observations
print(head(merged_data, 6))

# Print the last 6 observations
print(tail(merged_data, 6))
```

Address the missing values in each column.

```{r}
summary(merged_data)
cleaned_data <- na.omit(merged_data)

```

Compute the median alcohol content and international bitterness unit for each state. Plot a bar chart to compare.

```{r}
medians_by_state <- cleaned_data %>%
  group_by(State) %>%
  summarise(Median_ABV = median(ABV, na.rm = TRUE),
            Median_IBU = median(IBU, na.rm = TRUE))

ggplot(medians_by_state, aes(x = State)) +
  geom_bar(aes(y = Median_ABV, fill = "Median ABV"), stat = "identity", position = "dodge") +
  geom_bar(aes(y = Median_IBU, fill = "Median IBU"), stat = "identity", position = "dodge") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  labs(y = "Median Value", fill = "Metric") +
  ggtitle("Median Alcohol Content and IBU by State")
```

Which state has the maximum alcoholic (ABV) beer? Which state has the most bitter (IBU) beer?

```{r}
# Determine which state has the maximum ABV
 state_with_max_ABV <- cleaned_data[which.max(cleaned_data$ABV),]$State
 print(paste("The state with the maximum alcoholic (ABV) beer is", state_with_max_ABV))
 # Determine which state has the maximum IBU
state_with_max_IBU <- cleaned_data[which.max(cleaned_data$IBU),]$State
print(paste("The state with the most bitter (IBU) beer is", state_with_max_IBU))
```

Comment on the summary statistics and distribution of the ABV variable.
#Through an analysis of our beer dataset, we've identified key insights into the Alcohol by Volume (ABV) and International Bitterness Units (IBU). The ABV ranges from 0.1% to 12.8%, with the majority of beers sitting around 5.6%. However, the average ABV is slightly higher at 5.98%, indicating the presence of some significantly stronger beers. When it comes to bitterness as measured by IBUs, the median value is 35, but the mean is 42.71, showing that some beers have a considerably high bitterness level. A regional analysis highlights Kentucky as the producer of the beer with the highest ABV, while Oregon leads with the most bitter beer. It's important to note that these findings are based on our current dataset, and may not represent all beers. We also handled missing data points responsibly; specifically, 62 instances where the ABV was not recorded were excluded from the analysis. These insights could be valuable in shaping marketing strategies and understanding regional taste preferences.
Is there an apparent relationship between the bitterness of the beer and its alcoholic content? Draw a scatter plot.Â  Make your best judgment of a relationship and EXPLAIN your answer.

```{r}
ggplot(cleaned_data, aes(x = ABV, y = IBU)) +
  geom_point(alpha = 0.5) +
  theme_minimal() +
  labs(x = "Alcohol By Volume (ABV)", 
       y = "International Bitterness Units (IBU)", 
       title = "Relationship between Beer Bitterness and Alcoholic Content") +
  geom_smooth(method = "lm", se = FALSE, color = "blue")
```

